{"version":3,"sources":["../js/service.js"],"names":["private_cloud","service","$http","$rootScope","$timeout","getToken","userName","password","url","headers","Content-Type","method","data","auth","identity","methods","user","name","domain","scope","project","success","status","config","console","log","token","id","window","localStorage","setItem","token_promise","resolve","error","reject"],"mappings":";AAGAA,cAAcC,QAAQ,kBAAiB,SAAS,cAAc,YAAY,SAAUC,GAAOC,GAAYC;IACnG;QAQIC,UAAU,SAAUC,GAAUC;YAC1BL;gBACIM,KAAK;gBACLC;oBACIC,gBAAgB;;gBAEpBC,QAAQ;gBACRC;oBACIC;wBACIC;4BACIC,WACI;4BAEJR;gCACIS;oCACIC,MAAQX;oCACRY;wCACID,MAAQ;;oCAEZV,UAAYA;;;;wBAIxBY;4BACIC;gCACIH,MAAQ;gCACRC;oCACID,MAAQ;;;;;;eAM7BI,QAAQ,SAAUT,GAAMU,GAAQb,GAASc;gBACxCC,QAAQC,IAAIb,EAAKc,MAAMN,QAAQO,KAC/BH,QAAQC,IAAIH,IAGZM,OAAOC,aAAaC,QAAQ,SAAQrB,IAAU;gBAC9CmB,OAAOC,aAAaC,QAAQ,cAAalB,EAAKc,MAAMN,QAAQO,KAC5DxB,EAAW4B,cAAcC,QAAQvB,IAAU;eAE5CwB,MAAM,SAAUrB,GAAMU,GAAQb,GAASc;gBAGtCpB,EAAW4B,cAAcG,OAAO","file":"service.min.js","sourcesContent":["/**\n * Created by chenzhongying on 2018/1/9.\n */\nprivate_cloud.service('tokenService', ['$http', '$rootScope', '$timeout', function ($http, $rootScope, $timeout) {\n    return {\n        /*\"user\": {\n         \"name\": \"admin\",\n         \"domain\": {\n         \"name\": \"Default\"\n         },\n         \"password\": \"openstack\"\n         }*/\n        getToken: function (userName, password) { //登录服务用账号\n            $http({\n                url: './apiv1',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                method: 'POST',\n                data: {\n                    \"auth\": {\n                        \"identity\": {\n                            \"methods\": [\n                                \"password\"\n                            ],\n                            \"password\": {\n                                \"user\": {\n                                    \"name\": userName,\n                                    \"domain\": {\n                                        \"name\": \"Default\"\n                                    },\n                                    \"password\": password\n                                }\n                            }\n                        },\n                        \"scope\": {\n                            \"project\": {\n                                \"name\": \"admin\",\n                                \"domain\": {\n                                    \"name\": \"Default\"\n                                }\n                            }\n                        }\n                    }\n                }\n            }).success(function (data, status, headers, config) {\n                console.log(data.token.project.id);\n                console.log(status);\n                // this callback will be called asynchronously\n                // when the response is available\n                window.localStorage.setItem('token',headers()['x-subject-token']);\n                window.localStorage.setItem('project_id',data.token.project.id);\n                $rootScope.token_promise.resolve(headers()['x-subject-token']);\n\n            }).error(function (data, status, headers, config) {\n                // called asynchronously if an error occurs\n                // or server returns response with an error status.\n                $rootScope.token_promise.reject('获取token失败');\n            });\n        }\n    };\n\n}]);"]}